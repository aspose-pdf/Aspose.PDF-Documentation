---
title: Конвертация файла в PDF через действие рабочего процесса
type: docs
weight: 50
url: /ru/sharepoint/converting-a-file-to-pdf-via-workflow-activity/
lastmod: "2020-12-16"
description: PDF SharePoint API можно использовать в рабочем процессе SharePoint для конвертации документа в PDF.
---

{{% alert color="primary" %}}

Поддержка рабочих процессов является ключевой функциональностью Microsoft Office SharePoint Server. Рабочие процессы помогают автоматизировать перемещение документов в соответствии с бизнес-логикой и оптимизировать затраты и время на организацию документов. Эта статья демонстрирует, как использовать Aspose.PDF для SharePoint в рабочем процессе, который конвертирует документ в PDF.

{{% /alert %}}
## **Настройка рабочего процесса**

Этот пример создает рабочий процесс, который конвертирует любой новый элемент в библиотеке документов в формат PDF и сохраняет его в другой библиотеке документов. В примере используется библиотека **Личные документы** как исходная библиотека и подкаталог **Pdf** в библиотеке **Общие документы** как библиотека назначения.

Aspose.PDF для SharePoint поддерживает конвертацию HTML, текстовых и графических файлов.

### **Проектирование рабочего процесса с использованием SharePoint Designer**

1. Откройте **SharePoint Designer** и подключитесь к сайту, где будет реализован рабочий процесс.
1. Выберите **Рабочие процессы** из **объектов сайта**, а затем откройте **Рабочий процесс списка**.
1. Выберите библиотеку **Личные документы**, чтобы создать и прикрепить новый рабочий процесс списка к библиотеке документов.

   **Выбор Личные документы из меню**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_1.png)

1. Создайте и прикрепите рабочий процесс списка к библиотеке **Личные документы**, введя имя и описание рабочего процесса.
1. Нажмите **ОК**, чтобы завершить этот шаг.

   **Создание рабочего процесса списка**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_2.png)

Открывается редактор шагов рабочего процесса. Он используется для определения условий и действий для рабочих процессов. Теперь добавьте действие для преобразования нового документа в PDF без каких-либо условий из **Aspose Actions**.
1. Выберите действие **Конвертировать файл в PDF через Aspose.PDF** в меню **Действие**.

   **Выбор и действие**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_3.png)

1. Настройте параметры действия:
   1. Установите параметр **эту папку** в папку назначения.
   1. Либо оставьте остальные параметры действия значениями по умолчанию, либо установите их с помощью окна свойств действия. Значение по умолчанию для параметра **Перезаписать** - false.

      **Редактор Рабочего Процесса**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_4.png)

**Установка библиотеки назначения**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_5.png)

**Установка свойств**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_6.png)

1. В меню **Рабочий процесс** выберите **Настройки рабочего процесса**.
1. Выберите **автоматически запускать рабочий процесс при создании нового элемента** и снимите другие параметры в **Параметры запуска**.

   **Настройка параметров запуска**
![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_7.png)

Проектирование рабочего процесса завершено.

1. Сохраните и опубликуйте рабочий процесс, чтобы внедрить его на сайт SharePoint.

### **Тестирование рабочего процесса**

Чтобы протестировать рабочий процесс:

1. Откройте сайт SharePoint и загрузите новый документ в библиотеку документов **Personal Documents**.
   Aspose.PDF для SharePoint поддерживает конвертацию из HTML файлов, текстовых файлов и изображений (JPG, PNG, GIF, TIFF и BMP*) в PDF. Рабочий процесс настроен на автоматический запуск при создании нового элемента, поэтому файлы обрабатываются автоматически.
1. Обновите браузер.
   Статус рабочего процесса отображается в столбце рабочего процесса, в этом случае **Aspose.PDF Workflow**.

   **Добавление документа в исходную библиотеку**

![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_8.png)

1. Откройте библиотеку документов назначения, чтобы просмотреть преобразованный документ. **Shared Documents/Pdf** - это путь в этом примере.

   **Библиотека назначения**
![todo:image_alt_text](converting-a-file-to-pdf-via-workflow-activity_9.png)

## Преобразование файла в PDF через активность рабочего процесса

Этот документ описывает, как использовать активность рабочего процесса для преобразования файла в PDF. 

### Предварительные требования

- Установленное программное обеспечение для управления рабочими процессами.
- Доступ к системе с правами администратора.

### Шаги

1. **Добавьте активность рабочего процесса**: Перейдите в редактор рабочего процесса и добавьте активность "Конвертация в PDF".
2. **Настройте параметры**: Укажите входной файл и выходной формат как PDF.
3. **Запустите рабочий процесс**: Сохраните изменения и запустите рабочий процесс для выполнения преобразования.

```python
# Пример кода для запуска рабочего процесса
def старт_рабочего_процесса():
    # Настройка параметров
    параметры = {
        "входной_файл": "документ.docx",
        "выходной_файл": "документ.pdf",
    }
    # Запуск рабочего процесса
    запуск_процесса(параметры)
```

### Часто задаваемые вопросы

#### В: Могу ли я использовать эту активность для других форматов?

О: Да, активность поддерживает множество форматов для конвертации.

#### В: Что делать, если преобразование не удалось?

О: Проверьте, что входной файл не поврежден и у вас есть необходимые разрешения.

### Заключение

Следуя этим шагам, вы сможете успешно конвертировать файлы в PDF с помощью активности рабочего процесса.